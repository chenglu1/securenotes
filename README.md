# ğŸ”’ SecureNotes

> ç¦»çº¿ä¼˜å…ˆã€æ”¯æŒå®æ—¶åä½œã€ç«¯åˆ°ç«¯åŠ å¯†çš„ Markdown ç¬”è®°åº”ç”¨

<p align="center">
  <img src="https://img.shields.io/badge/Electron-28-47848F?logo=electron" />
  <img src="https://img.shields.io/badge/React-19-61DAFB?logo=react" />
  <img src="https://img.shields.io/badge/TypeScript-5-3178C6?logo=typescript" />
  <img src="https://img.shields.io/badge/Vite-5-646CFF?logo=vite" />
  <img src="https://img.shields.io/badge/NestJS-10-E0234E?logo=nestjs" />
</p>

---

## âœ¨ åŠŸèƒ½ç‰¹æ€§

| ç‰¹æ€§ | æè¿° |
|------|------|
| ğŸ“ **å¯Œæ–‡æœ¬ç¼–è¾‘** | åŸºäº TipTap çš„ Markdown ç¼–è¾‘å™¨ï¼Œæ”¯æŒæ ‡é¢˜ã€åˆ—è¡¨ã€ä»£ç å—ã€ä»»åŠ¡åˆ—è¡¨ç­‰ |
| ğŸ’¾ **ç¦»çº¿ä¼˜å…ˆ** | æ•°æ®å­˜å‚¨åœ¨æœ¬åœ° SQLite (sql.js WASM)ï¼Œæ— ç½‘ç»œä¹Ÿå¯æ­£å¸¸ä½¿ç”¨ |
| ğŸ”„ **å®æ—¶åä½œ** | åŸºäº Yjs CRDT çš„å¤šäººå®æ—¶åä½œç¼–è¾‘ï¼Œè‡ªåŠ¨è§£å†³å†²çª |
| ğŸ” **ç«¯åˆ°ç«¯åŠ å¯†** | ä½¿ç”¨ libsodium åŠ å¯†ï¼ŒæœåŠ¡ç«¯åªå­˜å‚¨å¯†æ–‡ï¼Œå¯†é’¥ç”±ç”¨æˆ·ç®¡ç† |
| ğŸ” **å…¨æ–‡æœç´¢** | å³æ—¶æœç´¢ç¬”è®°æ ‡é¢˜å’Œå†…å®¹ |
| ğŸ·ï¸ **æ ‡ç­¾ç³»ç»Ÿ** | æ”¯æŒåˆ›å»ºæ ‡ç­¾ã€ä¸ºç¬”è®°æ·»åŠ æ ‡ç­¾ |
| ğŸ“ **é™„ä»¶ç®¡ç†** | æ”¯æŒå›¾ç‰‡ã€PDF ç­‰æ–‡ä»¶é™„ä»¶ |
| ğŸŒ™ **æš—è‰²ä¸»é¢˜** | ç²¾å¿ƒè®¾è®¡çš„æš—è‰² UIï¼Œæ”¯æŒ Glassmorphism æ•ˆæœ |

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Electron Client                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Renderer (React)   â”‚  â”‚   Main Process       â”‚ â”‚
â”‚  â”‚                      â”‚  â”‚                      â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚  TipTap Editor â”‚  â”‚  â”‚  â”‚  IPC Handlers  â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚ Zustand Store  â”‚â—„â”€â”¼â”€â”€â”¼â”€â–ºâ”‚   sql.js WASM  â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â”‚    (SQLite)    â”‚  â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚  â”‚  Yjs (CRDT)    â”‚  â”‚  â”‚                      â”‚ â”‚
â”‚  â”‚  â”‚  Sync Engine   â”‚  â”‚  â”‚                      â”‚ â”‚
â”‚  â”‚  â”‚  libsodium     â”‚  â”‚  â”‚                      â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ WebSocket / REST API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              NestJS Backend (server/)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ JWT Auth â”‚  â”‚ Sync API  â”‚  â”‚ WebSocket åä½œ    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜                  â”‚           â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚           â”‚
â”‚          â”‚   PostgreSQL   â”‚             â”‚           â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯ |
|------|------|
| **å‰ç«¯æ¡†æ¶** | React 19 + TypeScript |
| **æ„å»ºå·¥å…·** | Vite 5 + vite-plugin-electron |
| **æ¡Œé¢æ¡†æ¶** | Electron 28 |
| **ç¼–è¾‘å™¨** | TipTap (ProseMirror) |
| **çŠ¶æ€ç®¡ç†** | Zustand |
| **æœ¬åœ°æ•°æ®åº“** | sql.js (WASM ç‰ˆ SQLite) |
| **CRDT** | Yjs |
| **åŠ å¯†** | libsodium-wrappers (Argon2id + XSalsa20-Poly1305) |
| **åç«¯** | NestJS 10 + TypeORM |
| **åç«¯æ•°æ®åº“** | PostgreSQL |
| **è®¤è¯** | JWT + bcrypt |

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- **Node.js** >= 18
- **npm** >= 9
- **PostgreSQL** (ä»…åç«¯éœ€è¦)

### å®‰è£…ä¸è¿è¡Œ

```bash
# å…‹éš†é¡¹ç›®
git clone <repo-url>
cd electron-vite-boilerplate

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æ¨¡å¼ (Electron + Vite HMR)
npm run dev
```

### å¯åŠ¨åç«¯ (å¯é€‰)

```bash
cd server
npm install

# é…ç½®æ•°æ®åº“è¿æ¥ (å¯åœ¨ app.module.ts ä¸­ä¿®æ”¹)
# é»˜è®¤: localhost:5432, ç”¨æˆ· postgres, æ•°æ®åº“ securenotes

npm run dev
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
electron-vite-boilerplate/
â”œâ”€â”€ electron/                    # Electron ä¸»è¿›ç¨‹
â”‚   â”œâ”€â”€ main.ts                  # çª—å£åˆ›å»º + åº”ç”¨ç”Ÿå‘½å‘¨æœŸ
â”‚   â”œâ”€â”€ preload.ts               # contextBridge API (IPC æ¡¥æ¥)
â”‚   â”œâ”€â”€ ipc-handlers.ts          # IPC å¤„ç†å™¨æ³¨å†Œ
â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â””â”€â”€ index.ts             # å…±äº«ç±»å‹å®šä¹‰ (Note, Tag, Attachment)
â”‚   â””â”€â”€ database/
â”‚       â”œâ”€â”€ connection.ts        # sql.js åˆå§‹åŒ– + æ–‡ä»¶æŒä¹…åŒ–
â”‚       â””â”€â”€ repositories/
â”‚           â”œâ”€â”€ notes.ts         # ç¬”è®° CRUD + æœç´¢
â”‚           â”œâ”€â”€ tags.ts          # æ ‡ç­¾ CRUD + å…³è”
â”‚           â””â”€â”€ attachments.ts   # é™„ä»¶æ–‡ä»¶ç®¡ç†
â”‚
â”œâ”€â”€ src/                         # æ¸²æŸ“è¿›ç¨‹ (React)
â”‚   â”œâ”€â”€ main.tsx                 # React å…¥å£
â”‚   â”œâ”€â”€ App.tsx                  # æ ¹ç»„ä»¶
â”‚   â”œâ”€â”€ vite-env.d.ts            # ç±»å‹å£°æ˜ (window.api)
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ layout/
â”‚   â”‚   â”‚   â”œâ”€â”€ AppShell.tsx     # ä¸‰æ å¸ƒå±€
â”‚   â”‚   â”‚   â””â”€â”€ Sidebar.tsx      # æœç´¢ + ç¬”è®°åˆ—è¡¨ + åŒæ­¥çŠ¶æ€
â”‚   â”‚   â””â”€â”€ editor/
â”‚   â”‚       â”œâ”€â”€ EditorPane.tsx   # TipTap ç¼–è¾‘å™¨ + è‡ªåŠ¨ä¿å­˜
â”‚   â”‚       â””â”€â”€ EditorToolbar.tsx# æ ¼å¼åŒ–å·¥å…·æ 
â”‚   â”œâ”€â”€ stores/
â”‚   â”‚   â””â”€â”€ noteStore.ts         # Zustand çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ collaboration.ts     # Yjs æ–‡æ¡£ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ syncEngine.ts        # å¢é‡åŒæ­¥å¼•æ“
â”‚   â”‚   â”œâ”€â”€ cryptoService.ts     # E2E åŠ å¯†æœåŠ¡
â”‚   â”‚   â””â”€â”€ mockApi.ts           # æµè§ˆå™¨å¼€å‘æ¨¡å¼ Mock API
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â””â”€â”€ useCollaboration.ts  # Yjs æ–‡æ¡£ç”Ÿå‘½å‘¨æœŸ Hook
â”‚   â””â”€â”€ styles/
â”‚       â””â”€â”€ index.css            # æš—è‰²ä¸»é¢˜è®¾è®¡ç³»ç»Ÿ
â”‚
â”œâ”€â”€ server/                      # NestJS åç«¯
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ main.ts              # NestJS å¯åŠ¨
â”‚       â”œâ”€â”€ app.module.ts        # æ ¹æ¨¡å— (TypeORM + JWT)
â”‚       â”œâ”€â”€ entities/
â”‚       â”‚   â”œâ”€â”€ note.entity.ts   # ç¬”è®°å®ä½“ (å­˜å‚¨å¯†æ–‡)
â”‚       â”‚   â””â”€â”€ user.entity.ts   # ç”¨æˆ·å®ä½“
â”‚       â”œâ”€â”€ auth/
â”‚       â”‚   â”œâ”€â”€ auth.module.ts
â”‚       â”‚   â”œâ”€â”€ auth.service.ts  # æ³¨å†Œ/ç™»å½• + JWT
â”‚       â”‚   â””â”€â”€ auth.controller.ts
â”‚       â”œâ”€â”€ sync/
â”‚       â”‚   â”œâ”€â”€ sync.module.ts
â”‚       â”‚   â”œâ”€â”€ sync.service.ts  # Push/Pull åŒæ­¥
â”‚       â”‚   â””â”€â”€ sync.controller.ts
â”‚       â””â”€â”€ collaboration/
â”‚           â”œâ”€â”€ collaboration.module.ts
â”‚           â””â”€â”€ collaboration.gateway.ts  # WebSocket ç½‘å…³
â”‚
â”œâ”€â”€ index.html                   # HTML å…¥å£
â”œâ”€â”€ vite.config.ts               # Vite + React + Electron é…ç½®
â”œâ”€â”€ tsconfig.json                # TypeScript é…ç½®
â”œâ”€â”€ package.json
â””â”€â”€ electron-builder.json5       # Electron æ‰“åŒ…é…ç½®
```

---

## ğŸ”§ æ ¸å¿ƒæ¨¡å—è¯´æ˜

### 1. IPC é€šä¿¡

åº”ç”¨ä½¿ç”¨ Electron çš„ `contextBridge` è¿›è¡Œå®‰å…¨çš„è¿›ç¨‹é—´é€šä¿¡ï¼š

```
Renderer (React)         Preload              Main Process
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
window.api.xxx()  â†’  ipcRenderer.invoke()  â†’  ipcMain.handle()
                                               â”‚
                                               â–¼
                                           Repository
                                               â”‚
                                               â–¼
                                           sql.js DB
```

`window.api` æä¾›çš„æ–¹æ³•ï¼š

| æ–¹æ³• | è¯´æ˜ |
|------|------|
| `getNotes()` | è·å–æ‰€æœ‰ç¬”è®° |
| `createNote(data)` | åˆ›å»ºç¬”è®° |
| `updateNote(id, data)` | æ›´æ–°ç¬”è®° |
| `deleteNote(id)` | åˆ é™¤ç¬”è®° (è½¯åˆ é™¤) |
| `searchNotes(query)` | æœç´¢ç¬”è®° |
| `getTags()` | è·å–æ‰€æœ‰æ ‡ç­¾ |
| `createTag(data)` | åˆ›å»ºæ ‡ç­¾ |
| `addTagToNote(noteId, tagId)` | æ·»åŠ æ ‡ç­¾åˆ°ç¬”è®° |
| `addAttachment(noteId, path)` | æ·»åŠ é™„ä»¶ |

### 2. æ•°æ®åº“ (sql.js)

ä½¿ç”¨ WASM ç‰ˆ SQLiteï¼Œæ— éœ€åŸç”Ÿç¼–è¯‘ï¼š

- **åˆå§‹åŒ–**: åº”ç”¨å¯åŠ¨æ—¶å¼‚æ­¥åŠ è½½ WASM äºŒè¿›åˆ¶
- **æŒä¹…åŒ–**: æ¯æ¬¡å†™æ“ä½œåè°ƒç”¨ `saveDatabase()` å°†å†…å­˜æ•°æ®å†™å…¥ç£ç›˜
- **å­˜å‚¨ä½ç½®**: `%APPDATA%/electron-vite-boilerplate/securenotes.db`

### 3. TipTap ç¼–è¾‘å™¨

ç¼–è¾‘å™¨é…ç½®äº†ä»¥ä¸‹æ‰©å±•ï¼š

| æ‰©å±• | åŠŸèƒ½ |
|------|------|
| `StarterKit` | åŸºç¡€æ ¼å¼ (æ®µè½ã€æ ‡é¢˜ã€åˆ—è¡¨ã€å¼•ç”¨ç­‰) |
| `Placeholder` | ç©ºå†…å®¹æç¤ºæ–‡å­— |
| `Highlight` | æ–‡å­—é«˜äº® |
| `TaskList/TaskItem` | ä»»åŠ¡åˆ—è¡¨ (å¤é€‰æ¡†) |
| `Link` | è¶…é“¾æ¥ (è‡ªåŠ¨æ£€æµ‹) |
| `Image` | å›¾ç‰‡æ’å…¥ |
| `Collaboration` | Yjs CRDT åä½œ (é¢„ç•™) |

### 4. ç«¯åˆ°ç«¯åŠ å¯†

```
ç”¨æˆ·å¯†ç  â†’ Argon2id â†’ ä¸»å¯†é’¥
                        â”‚
                        â–¼
                 ç¬”è®°å†…å®¹ â†’ XSalsa20-Poly1305 åŠ å¯† â†’ å¯†æ–‡
                                                     â”‚
                                                     â–¼
                                              å­˜å‚¨/ä¼ è¾“åˆ°æœåŠ¡å™¨
```

- **å¯†é’¥æ´¾ç”Ÿ**: Argon2id (æŠ— GPU æš´åŠ›ç ´è§£)
- **å¯¹ç§°åŠ å¯†**: XSalsa20-Poly1305 (AEAD)
- **å¯†é’¥åˆ†äº«**: Sealed Box (åŒ¿åå…¬é’¥åŠ å¯†)

### 5. åŒæ­¥å¼•æ“

```
æœ¬åœ°ä¿®æ”¹ â†’ æ ‡è®° is_dirty â†’ å…¥é˜Ÿ â†’ æ‰¹é‡å‘é€ â†’ æœåŠ¡å™¨ç¡®è®¤ â†’ æ ‡è®°å·²åŒæ­¥
                                     â†‘
                            å¤±è´¥åé‡è¯• (æœ€å¤š 5 æ¬¡)
```

### 6. åç«¯ API

| ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/auth/register` | POST | æ³¨å†Œç”¨æˆ· |
| `/auth/login` | POST | ç™»å½•è·å– JWT |
| `/api/sync/push` | POST | æ¨é€ç¬”è®°å˜æ›´ |
| `/api/sync/pull?since=N` | GET | æ‹‰å–å¢é‡æ›´æ–° |
| `/api/sync/notes` | GET | è·å–æ‰€æœ‰ç¬”è®° |
| WebSocket `/collaboration` | - | å®æ—¶åä½œ (Yjs æ›´æ–°è½¬å‘) |

---

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### å¸¸ç”¨å‘½ä»¤

```bash
npm run dev          # å¯åŠ¨å¼€å‘ (Vite HMR + Electron)
npm run build        # æ„å»ºç”Ÿäº§ç‰ˆæœ¬ + æ‰“åŒ… Electron
npm run preview      # é¢„è§ˆæ„å»ºç»“æœ
```

### æ·»åŠ æ–°çš„ IPC æ–¹æ³•

1. åœ¨ `electron/types/index.ts` æ·»åŠ ç±»å‹
2. åœ¨å¯¹åº”çš„ `repositories/` ä¸­æ·»åŠ æ•°æ®æ“ä½œæ–¹æ³•
3. åœ¨ `electron/ipc-handlers.ts` æ³¨å†Œ `ipcMain.handle`
4. åœ¨ `electron/preload.ts` æš´éœ²æ–¹æ³•åˆ° `window.api`
5. åœ¨ `src/services/mockApi.ts` æ·»åŠ å¯¹åº”çš„ mock å®ç°

### æ·»åŠ æ–°çš„ç¼–è¾‘å™¨åŠŸèƒ½

1. å®‰è£… TipTap æ‰©å±•: `npm install @tiptap/extension-xxx`
2. åœ¨ `EditorPane.tsx` çš„ `extensions` æ•°ç»„ä¸­æ³¨å†Œ
3. åœ¨ `EditorToolbar.tsx` æ·»åŠ å·¥å…·æ æŒ‰é’®

### æµè§ˆå™¨å¼€å‘æ¨¡å¼

ç›´æ¥è®¿é—® `http://localhost:5173` å¯ä»¥åœ¨æµè§ˆå™¨ä¸­é¢„è§ˆ UIï¼Œæ— éœ€å¯åŠ¨ Electronã€‚æ­¤æ¨¡å¼ä½¿ç”¨ `mockApi.ts` æä¾›çš„å†…å­˜æ•°æ®ï¼Œä¸æŒä¹…åŒ–ã€‚

---

## ğŸ“¦ æ„å»ºä¸æ‰“åŒ…

```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build
```

ç”Ÿæˆæ–‡ä»¶ä½äº `release/` ç›®å½•ã€‚æ‰“åŒ…é…ç½®è§ `electron-builder.json5`ã€‚

---

## ğŸ¤ åä½œå¼€å‘æµç¨‹

```mermaid
graph LR
  A[ç”¨æˆ· A ç¼–è¾‘] --> B[Yjs ç”Ÿæˆ Update]
  B --> C[WebSocket å‘é€]
  C --> D[æœåŠ¡ç«¯è½¬å‘]
  D --> E[ç”¨æˆ· B æ¥æ”¶]
  E --> F[Yjs åˆå¹¶ CRDT]
  F --> G[UI è‡ªåŠ¨æ›´æ–°]
```

1. æ¯ä¸ªç¬”è®°å¯¹åº”ä¸€ä¸ª `Y.Doc` å®ä¾‹
2. ç¼–è¾‘æ“ä½œç”Ÿæˆ Yjs Update (å¢é‡äºŒè¿›åˆ¶)
3. é€šè¿‡ WebSocket è½¬å‘ç»™åŒä¸€ç¬”è®°çš„å…¶ä»–åä½œè€…
4. CRDT ç®—æ³•è‡ªåŠ¨è§£å†³å†²çªï¼Œæ— éœ€æ‰‹åŠ¨åˆå¹¶

---

## ğŸ“‹ æ•°æ®åº“è¡¨ç»“æ„

```sql
-- ç¬”è®°
CREATE TABLE notes (
  id            TEXT PRIMARY KEY,     -- UUID
  title         TEXT DEFAULT '',
  content       TEXT DEFAULT '',      -- TipTap HTML
  created_at    TEXT,
  updated_at    TEXT,
  deleted_at    TEXT,                  -- è½¯åˆ é™¤
  sync_version  INTEGER DEFAULT 0,
  is_dirty      INTEGER DEFAULT 1     -- å¾…åŒæ­¥æ ‡è®°
);

-- æ ‡ç­¾
CREATE TABLE tags (
  id    TEXT PRIMARY KEY,
  name  TEXT UNIQUE,
  color TEXT DEFAULT '#6366f1'
);

-- ç¬”è®°-æ ‡ç­¾å…³è”
CREATE TABLE note_tags (
  note_id TEXT REFERENCES notes(id),
  tag_id  TEXT REFERENCES tags(id),
  PRIMARY KEY (note_id, tag_id)
);

-- é™„ä»¶
CREATE TABLE attachments (
  id          TEXT PRIMARY KEY,
  note_id     TEXT REFERENCES notes(id),
  filename    TEXT,
  mime_type   TEXT,
  size_bytes  INTEGER,
  file_path   TEXT,                   -- userData ä¸‹çš„ç›¸å¯¹è·¯å¾„
  created_at  TEXT
);
```

---

## ğŸ“„ License

MIT
